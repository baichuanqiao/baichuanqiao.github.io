<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>基于Intellij IDEA的Spark开发-Scala | baichuan upup</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="用Scala写一些Spark小程序">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Intellij IDEA的Spark开发-Scala">
<meta property="og:url" content="http://yoursite.com/2017/01/18/Scala/index.html">
<meta property="og:site_name" content="baichuan upup">
<meta property="og:description" content="用Scala写一些Spark小程序">
<meta property="og:image" content="http://wx4.sinaimg.cn/mw690/005PiU9ugy1fbv9yhljmjj30bf0ez0t7.jpg">
<meta property="og:updated_time" content="2017-01-19T10:44:17.496Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="基于Intellij IDEA的Spark开发-Scala">
<meta name="twitter:description" content="用Scala写一些Spark小程序">
<meta name="twitter:image" content="http://wx4.sinaimg.cn/mw690/005PiU9ugy1fbv9yhljmjj30bf0ez0t7.jpg">
  
    <link rel="alternative" href="/atom.xml" title="baichuan upup" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/panda.png">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: null
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/panda.png" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">baichuan</a></h1>
        </hgroup>

        
        <p class="header-subtitle">我挥舞着键盘和本子,发誓要把世界写个明白.</p>
        
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">博客首页</a></li>
                        
                            <li><a href="/archives/">作品展示</a></li>
                        
                            <li><a href="/tags/">标签云</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl mail" target="_blank" href="mailto:baichuanqiao@gmail.com" title="mail">mail</a>
                            
                                <a class="fl github" target="_blank" href="https://github.com/baichuanqiao" title="github">github</a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/HashMap/" style="font-size: 10px;">HashMap</a> <a href="/tags/Hashmap/" style="font-size: 10px;">Hashmap</a> <a href="/tags/Linked-List/" style="font-size: 10px;">Linked List</a> <a href="/tags/Scala/" style="font-size: 10px;">Scala</a> <a href="/tags/Sublime-Text/" style="font-size: 10px;">Sublime Text</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://luuman.github.io/">luuman</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://moxfive.xyz/">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">前端小弱鸡</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">baichuan</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/panda.png" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">baichuan</a></h1>
            </hgroup>
            
            <p class="header-subtitle">我挥舞着键盘和本子,发誓要把世界写个明白.</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">博客首页</a></li>
                
                    <li><a href="/archives/">作品展示</a></li>
                
                    <li><a href="/tags/">标签云</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="mail" target="_blank" href="mailto:baichuanqiao@gmail.com" title="mail">mail</a>
                    
                        <a class="github" target="_blank" href="https://github.com/baichuanqiao" title="github">github</a>
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-Scala" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2017/01/18/Scala/" class="article-date">
      <time datetime="2017-01-18T03:28:03.000Z" itemprop="datePublished">2017-01-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      基于Intellij IDEA的Spark开发-Scala
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/Spark/">Spark</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Scala/">Scala</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><excerpt in="" index="" |="" 首页摘要=""><br>用Scala写一些Spark小程序<a id="more"></a></excerpt></p>
<h2 id="开发语言的选择"><a href="#开发语言的选择" class="headerlink" title="开发语言的选择"></a>开发语言的选择</h2><p>Spark开发语言可以选择Scala，Java和Python。虽然相对而言更熟悉Java一点，最终还是决定选择Scala作为Spark的主要开发语言。原因有以下几个：</p>
<ol>
<li>Scala是Spark的原生语言，兼容性最强,据说性能也更好。</li>
<li>这学期研讨内容就是Scala,如果不结合点大数据相关的内容而是单纯介绍这门语言的话会十分无趣，也说明不了Scala的价值所在。</li>
<li>Scala是基于JVM的，方便兼容其他基于Java语言的大数据系统。</li>
<li>Scala有逼格啊hhh，不是还有人说有望成为下一代的Java吗！</li>
</ol>
<h2 id="Scala环境配置"><a href="#Scala环境配置" class="headerlink" title="Scala环境配置"></a>Scala环境配置</h2><p>首先你想用Scala的话请确保已经安装了JDK1.5以上版本，用过Java同学的这步就可以跳过了，然后去<a href="http://www.scala-lang.org/" target="_blank" rel="external">官网</a>下载二进制安装包然后配置环境变量啊balabala我就不说了，网上都有。这里就提一下用到的编译器IntelliJ  IDEA中直接安装Scala插件，不得不说这款编译器是我继VS后遇到的第二款宇宙级IDE，反正用它敲代码比Eclipse效率要高一些(比如代码补全就更加智能一些)。<a href="https://www.jetbrains.com/idea/" target="_blank" rel="external">IntelliJ  IDEA</a>是JetBrains公司开发的一系列编程工具中的一款，面向社会的话是收费的，不过对我们大学生的话可以用学生邮箱注册免费使用！安装后我们打开File-Settings-Plugins，下方找到Install Jetbrains plugins然后输入Scala就能找到插件了，我们不妨看看Scala的流行程度吧。<br><img src="http://wx4.sinaimg.cn/mw690/005PiU9ugy1fbv9yhljmjj30bf0ez0t7.jpg" alt="插件下载量排名"></p>
<p>图上可见Scala下载量是最多的，究其原因也是和最近大数据的热门有关。</p>
<h2 id="Spark环境配置"><a href="#Spark环境配置" class="headerlink" title="Spark环境配置"></a>Spark环境配置</h2><p>Spark的jar包可以去<a href="http://spark.apache.org/" target="_blank" rel="external">官网</a>下载，以1.5.0版本的Spark为例，我们需要用的是lib下的spark-assembly-1.5.0-hadoop2.4.0.jar这个包。首先在编译器内新建一个Scala项目，然后在项目页File- project structure-Libraries,点“+”，选Java，找到spark-assembly-1.5.0-hadoop2.4.0.jar导入，这样就可以编写spark的scala程序了。这里需要特别提的两点是：我们编写的Scala程序要想运行，你可以选择在本地跑，当然也可以把程序打包成jar包发布到Spark集群上跑，前者对机器配置的要求低一些，适合电脑内存低的用户使用，毕竟集群要在虚拟机上跑的。还有就是Scala和Spark的版本最好是要匹配，就我本人来说Spark用的是1.5.0版本，开始用最新的Scala版本时程序运行会报错，把Scala版本降到2.10.6后就正常了。</p>
<h3 id="Spark集群上运行Scala程序"><a href="#Spark集群上运行Scala程序" class="headerlink" title="Spark集群上运行Scala程序"></a>Spark集群上运行Scala程序</h3><p>关于Scala集群的搭建网上都有，当然Spark集群要依赖于Hadoop集群，所以你首先还要去安装Hadoop，两个集群配好后怎么生成jar包发布到集群上呢？<br>1.在IntelliJ  IDEA里点击File-Project Structure-Artifacts-“+”-Jar-From modules with dependencies…”，填写modules、MainClass以及路径等，点击OK生成jar包。<br>2.点击Build-Build artifacts，选择刚生成的jar包进行build。<br>3.将打包好的jar包上传到服务器某路径下。<br>4.执行命令spark-submit WhereIsYourJar 其他参数。</p>
<h3 id="本地运行Scala程序"><a href="#本地运行Scala程序" class="headerlink" title="本地运行Scala程序"></a>本地运行Scala程序</h3><p>这也是我本人用的方法，因为方便不用配环境，本地跑的话就要在程序中通过setMaster来设置程序要连接的Spark集群的Master的URL，改为local即可下文还会有示例。</p>
<h2 id="第一个Spark程序"><a href="#第一个Spark程序" class="headerlink" title="第一个Spark程序"></a>第一个Spark程序</h2><p>类似于我们入门很多语言时的Hello World，在Spark里什么可以作为第一个小程序呢，最经典的一个莫过于WorldCount了，词频数统计就是统计一个或者多个文件中单词出现的次数。首先看下代码：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">package baichuan</div><div class="line">/**</div><div class="line">  * 使用Scala开发本地测试的Spark WordCount程序</div><div class="line">  */</div><div class="line">import org.apache.spark.SparkConf</div><div class="line">import org.apache.spark.SparkContext</div><div class="line">object WordCount &#123;</div><div class="line">def main(args: Array[String]): Unit = &#123;</div><div class="line">    val conf = new SparkConf()</div><div class="line">    conf.setAppName(<span class="string">"MyFirstSparkApplication"</span>)  </div><div class="line">    conf.setMaster(<span class="string">"local"</span>)   </div><div class="line">    val sc = new SparkContext(conf)     </div><div class="line">    val lines= sc.textFile(<span class="string">"G:\\Scala\\test.txt"</span>, 1)    </div><div class="line">    val words = lines.flatMap &#123; line =&gt; line.split(<span class="string">" "</span>) &#125;  </div><div class="line">    val pairs = words.map &#123; word =&gt; (word,1) &#125;</div><div class="line">    val wordCounts = pairs.reduceByKey(_+_)       </div><div class="line">    wordCounts.foreach(wordNumberPair =&gt; println(wordNumberPair._1 + <span class="string">" : "</span> + wordNumberPair._2))</div><div class="line">    sc.stop()    </div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>从上面我们可以看出代码还是很短的，但是却能实现一个很实用的计数功能，如果你用Java或者C++写同样功能的程序时代码一定是比这个多很多的，说明Scala在大数据处理方面的确有着优势。鉴于是第一个程序，这里详细讲解一下一些重要也是基本的语法结构。首先import两个包，这是Spark程序所必需的。我们第一步是要创建Spark的配置对象SparkConf，设置Spark程序的运行时的配置信息，例如说通过setMaster来设置程序要连接的Spark集群的Master的URL，如果设置为local，则代表Spark程序在本地运行，特别适合于配置条件的较差的人。第二步:创建SparkContext对象，SparkContext是Spark程序所有功能的唯一入口，无论是采用Scala，Java，Python等都必须有一个SparkContext，它的核心作用是初始化Spark应用程序运行所需要的核心组件，是整个Spark应用程序中最为至关重要的一个对象。然后是读取本地文件。紧接着就是核心的处理方法了：<br>1.使用 flatMap 算子把一行文本 split 成多个单词<br>2.使用 map 算子把单个的单词转化成一个有计数的 Key-Value 对，即 word -&gt; (word,1)<br>3.统计相同单词的出现次数需要使用 reduceByKey 算子把相同单词的计数相加得到最终结果<br>最后一定注意要将SparkContext的对象停止，因为SparkContext运行时会创建很多的对象。然后我们就可以再txt文档里输入一些单词测试程序了，程序运行之后一定会有一个错误，因为没有hadoop环境，这个不是程序错误，也不影响任何功能。</p>
<h2 id="Spark程序处理大数据"><a href="#Spark程序处理大数据" class="headerlink" title="Spark程序处理大数据"></a>Spark程序处理大数据</h2><p>假设我们需要统计一个 1000 万人口的所有人的平均年龄，你也可以改成1个亿来测试Spark 对于大数据的处理能力，无非就是本地运行时间长短而已。假设这些年龄信息都存储在一个文件里，并且该文件的格式如下，第一列是 ID，第二列是年龄。现在我们需要用 Scala 写一个生成 1000 万人口年龄数据的文件，源程序如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">package baichuan</div><div class="line">import java.io.FileWriter</div><div class="line">import java.io.File</div><div class="line">import scala.util.Random</div><div class="line">object SampleDataFileGenerator &#123;</div><div class="line">    def main(args:Array[String]) &#123;</div><div class="line">    val writer = new FileWriter(new File(<span class="string">"G:\\Scala\\sample_age_data.txt"</span>),<span class="literal">false</span>)</div><div class="line">    val rand = new Random()</div><div class="line">    <span class="keyword">for</span> ( i &lt;- 1 to 10000000) &#123;</div><div class="line">      writer.write( i + <span class="string">" "</span> + rand.nextInt(100))</div><div class="line">      writer.write(System.getProperty(<span class="string">"line.separator"</span>))</div><div class="line">    &#125;</div><div class="line">    writer.flush()</div><div class="line">    writer.close()</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>紧接着是对数据进行处理，源程序如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">package baichuan</div><div class="line">import org.apache.spark.SparkConf</div><div class="line">import org.apache.spark.SparkContext</div><div class="line"></div><div class="line">object AvgAgeCalculator &#123;</div><div class="line">    def main(args:Array[String]) &#123;</div><div class="line">    val conf = new SparkConf()</div><div class="line">    conf.setMaster(<span class="string">"local"</span>)</div><div class="line">    conf.setAppName(<span class="string">"MySparkApplication"</span>)</div><div class="line">    val sc = new SparkContext(conf)</div><div class="line">    val dataFile = sc.textFile(<span class="string">"G:\\Scala\\sample_age_data.txt"</span>, 5)</div><div class="line">    val count = dataFile.count()</div><div class="line">    val ageData = dataFile.map(line =&gt; line.split(<span class="string">" "</span>)(1))</div><div class="line">    val totalAge = ageData.map(age =&gt; Integer.parseInt(</div><div class="line">    String.valueOf(age))).collect().sum</div><div class="line">    println(<span class="string">"Total Age:"</span> + totalAge + <span class="string">";Number of People:"</span> + count )</div><div class="line">    val avgAge : Double = totalAge.toDouble / count.toDouble</div><div class="line">    println(<span class="string">"Average Age is "</span> + avgAge)</div><div class="line">    sc.stop()</div><div class="line"></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>要计算平均年龄，那么首先需要对源文件对应的 RDD (弹性分布式数据集) 进行处理，也就是将它转化成一个只包含年龄信息的 RDD，其次是计算元素个数即为总人数，然后是把所有年龄数加起来，最后平均年龄=总年龄/人数。对于第一步我们需要使用 map 算子把源文件对应的 RDD 映射成一个新的只包含年龄数据的 RDD，很显然需要对在 map 算子的传入函数中使用 split 方法，得到数组后只取第二个元素即为年龄信息；第二步计算数据元素总数需要对于第一步映射的结果 RDD 使用 count 算子；第三步则是使用 reduce 算子对只包含年龄信息的 RDD 的所有元素用加法求和；最后使用除法计算平均年龄即可。<br>这个程序我在本地跑了也就5s左右，要注意的是所有数据都放在一个文档里，因此这里并不能体现Spark独有的分布式计算优势。</p>
<h2 id="Spark-job的执行流程"><a href="#Spark-job的执行流程" class="headerlink" title="Spark job的执行流程"></a>Spark job的执行流程</h2><p>Spark 应用程序在提交执行后，控制台会打印很多日志信息，体现了一个被提交的 Spark job 在集群中是如何被调度执行的。先来搞清几个概念：<br><code>DAG</code>: 即 Directed Acyclic  Graph，有向无环图，这是一个图论中的概念。如果一个有向图无法从某个顶点出发经过若干条边回到该点，则这个图是一个有向无环图。<br><code>Job</code>：Spark 的计算操作是 lazy 执行的，只有当碰到一个动作 (Action) 算子时才会触发真正的计算。一个 Job 就是由动作算子而产生包含一个或多个 Stage 的计算作业。<br><code>Stage</code>：Job 被确定后,Spark 的调度器 (DAGScheduler) 会根据该计算作业的计算步骤把作业划分成一个或者多个 Stage。Stage 又分为 ShuffleMapStage 和 ResultStage，前者以 shuffle 为输出边界，后者会直接输出结果，其边界可以是获取外部数据，也可以是以一个 ShuffleMapStage 的输出为边界。每一个 Stage 将包含一个 TaskSet。<br><code>TaskSet</code>： 代表一组相关联的没有 shuffle 依赖关系的任务组成任务集。一组任务会被一起提交到更加底层的 TaskScheduler。<br><code>Task</code>：代表单个数据分区上的最小处理单元。分为 ShuffleMapTask 和 ResultTask。ShuffleMapTask 执行任务并把任务的输出划分到 (基于 task 的对应的数据分区) 多个 bucket(ArrayBuffer) 中,ResultTask 执行任务并把任务的输出发送给驱动程序。总之Spark 的作业任务调度是复杂的，需要结合源码来进行较为详尽的分析。大致的流程如下：<br>Spark 应用程序被提交后，当某个动作算子触发了计算操作时，SparkContext 会向 DAGScheduler 提交一个作业，接着 DAGScheduler 会根据 RDD 生成的依赖关系划分 Stage，并决定各个 Stage 之间的依赖关系，Stage 之间的依赖关系就形成了 DAG。Stage 的划分是以 ShuffleDependency 为依据的，也就是说当某个 RDD 的运算需要将数据进行 Shuffle 时，这个包含了 Shuffle 依赖关系的 RDD 将被用来作为输入信息，进而构建一个新的 Stage。我们可以看到用这样的方式划分 Stage，能够保证有依赖关系的数据可以以正确的顺序执行。根据每个 Stage 所依赖的 RDD 数据的 partition 的分布，会产生出与 partition 数量相等的 Task，这些 Task 根据 partition 的位置进行分布。其次对于 finalStage 或是 mapStage 会产生不同的 Task，最后所有的 Task 会封装到 TaskSet 内提交到 TaskScheduler 去执行。</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a href="/2017/01/18/Scala/">基于Intellij IDEA的Spark开发-Scala</a></p>
        <p><span>文章作者:</span><a href="/" title="访问 baichuan 的个人博客">baichuan</a></p>
        <p><span>发布时间:</span>2017年01月18日 - 11时28分</p>
        <p><span>最后更新:</span>2017年01月19日 - 18时44分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2017/01/18/Scala/" title="基于Intellij IDEA的Spark开发-Scala">http://yoursite.com/2017/01/18/Scala/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2017/01/18/Scala/　　作者: baichuan" title="点击复制文章链接"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2017/01/31/LeetCode1/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          LeetCode-Java题解(1)
        
      </div>
    </a>
  
  
    <a href="/2016/12/23/Sublime Text 3入坑小记/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">Sublime Text 3入坑小记</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#开发语言的选择"><span class="toc-number">1.</span> <span class="toc-text">开发语言的选择</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Scala环境配置"><span class="toc-number">2.</span> <span class="toc-text">Scala环境配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark环境配置"><span class="toc-number">3.</span> <span class="toc-text">Spark环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spark集群上运行Scala程序"><span class="toc-number">3.1.</span> <span class="toc-text">Spark集群上运行Scala程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#本地运行Scala程序"><span class="toc-number">3.2.</span> <span class="toc-text">本地运行Scala程序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#第一个Spark程序"><span class="toc-number">4.</span> <span class="toc-text">第一个Spark程序</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark程序处理大数据"><span class="toc-number">5.</span> <span class="toc-text">Spark程序处理大数据</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spark-job的执行流程"><span class="toc-number">6.</span> <span class="toc-text">Spark job的执行流程</span></a></li></ol>
</div>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
      <div class="duoshuo" id="comments">
    <!-- 多说评论框 start -->
    <div class="ds-thread" data-thread-key="2017/01/18/Scala/" data-title="基于Intellij IDEA的Spark开发-Scala" data-url="http://yoursite.com/2017/01/18/Scala/"></div>
    <!-- 多说评论框 end -->
    <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
    <script type="text/javascript">
    var duoshuoQuery = {short_name:"baichuan"};
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = '/js/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0] 
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
    </script>
    <!-- 多说公共JS代码 end -->
</div>

    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2017/01/31/LeetCode1/" title="上一篇: LeetCode-Java题解(1)">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2016/12/23/Sublime Text 3入坑小记/" title="下一篇: Sublime Text 3入坑小记">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/02/16/LeetCode49/">LeetCode-Java题解(49)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/02/PAT乙级1003/">PAT乙级题解(1003)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/01/LeetCode2/">LeetCode-Java题解(2)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/31/LeetCode1/">LeetCode-Java题解(1)</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/01/18/Scala/">基于Intellij IDEA的Spark开发-Scala</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/23/Sublime Text 3入坑小记/">Sublime Text 3入坑小记</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/12/20/markdown/">markdown格式测试</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2017 baichuan
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>